---
const testimonials = [
  {
    id: 1,
    text: "One of the only Canadian options. Great customer service. And the app is easy to use. Never given me issues yet.",
    author: "joe stone",
    source: "Google Play Store",
    avatar: "https://ui-avatars.com/api/?name=JS&background=ea580c&color=fff",
    sourceIcon: "google-play"
  },
  {
    id: 2,
    text: "Life is like a sandwich, no matter how you flip it, the bread comes first. Thank you for a platform to help me get it! ðŸž",
    author: "Costa prava",
    source: "Apple App Store", 
    avatar: "https://ui-avatars.com/api/?name=CP&background=0ea5e9&color=fff",
    sourceIcon: "apple"
  },
  {
    id: 3,
    text: "Very nice, clean interface for anyone just getting into crypto this is a great place to start.",
    author: "Jonathan Watts",
    source: "Google Play Store",
    avatar: "https://ui-avatars.com/api/?name=JW&background=ea580c&color=fff",
    sourceIcon: "google-play"
  },
  {
    id: 4,
    text: "This Is Definitely One of the Best Exchanges For Canadians. Very Simple and easy! If people have problems with it, it must because you're doing something wrong.",
    author: "Dendvwg",
    source: "Apple App Store",
    avatar: "https://ui-avatars.com/api/?name=DV&background=0ea5e9&color=fff",
    sourceIcon: "apple"
  },
  {
    id: 5,
    text: "Love the new app! Makes it's so much easier for newbies like me to trade crypto!",
    author: "@MoAlkhooly",
    source: "Twitter",
    avatar: "https://ui-avatars.com/api/?name=MA&background=1d4ed8&color=fff",
    sourceIcon: "twitter"
  },
  {
    id: 6,
    text: "Much Wow. Such Good",
    author: "Jeshua Williams",
    source: "Apple App Store",
    avatar: "https://ui-avatars.com/api/?name=JW&background=0ea5e9&color=fff",
    sourceIcon: "apple"
  }
];

// Duplicate testimonials to create seamless marquee effect
const rowOne = [...testimonials, ...testimonials, ...testimonials];
const rowTwo = [...testimonials, ...testimonials, ...testimonials];

const getSourceIcon = (source) => {
  switch(source) {
    case 'google-play':
      return `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
        <path d="M3 20.5V3.5C3 3.14 3.08 2.79 3.24 2.47L12.31 12L3.24 21.53C3.08 21.21 3 20.86 3 20.5Z" fill="#EA4335"/>
        <path d="M16.83 15.73L20.25 14.04C20.91 13.74 21 13.26 21 12.74S20.91 11.74 20.25 11.44L16.83 9.75L12.31 12L16.83 15.73Z" fill="#FBBC04"/>
        <path d="M3.24 2.47C3.64 1.67 4.5 1.45 5.27 1.87L16.83 9.75L12.31 12L3.24 2.47Z" fill="#4285F4"/>
        <path d="M3.24 21.53L12.31 12L16.83 15.73L5.27 22.13C4.5 22.55 3.64 22.33 3.24 21.53Z" fill="#34A853"/>
      </svg>`;
    case 'apple':
      return `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="#007AFF">
        <path d="M18.71 19.5C17.88 20.74 17 21.95 15.66 21.97C14.32 22 13.89 21.18 12.37 21.18C10.84 21.18 10.37 21.95 9.1 22C7.79 22.05 6.8 20.68 5.96 19.47C4.25 17 2.94 12.45 4.7 9.39C5.57 7.87 7.13 6.91 8.82 6.88C10.1 6.86 11.32 7.75 12.11 7.75C12.89 7.75 14.37 6.68 15.92 6.84C16.57 6.87 18.39 7.1 19.56 8.82C19.47 8.88 17.39 10.1 17.41 12.63C17.44 15.65 20.06 16.66 20.09 16.67C20.06 16.74 19.67 18.11 18.71 19.5ZM13 3.5C13.73 2.67 14.94 2.04 15.94 2C16.07 3.17 15.6 4.35 14.9 5.19C14.21 6.04 13.07 6.7 11.95 6.61C11.8 5.46 12.36 4.26 13 3.5Z"/>
      </svg>`;
    case 'twitter':
      return `<svg class="w-5 h-5" viewBox="0 0 24 24" fill="#1D9BF0">
        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
      </svg>`;
    default:
      return '';
  }
};
---

<section class="py-20" style="background-color: #0076CC;">
  <div class="container-custom">
    <div class="text-center mb-12">
      <h2 class="text-5xl text-white mb-4">
        Love from our users
      </h2>
    </div>

    <!-- Row 1 - scroll left -->
    <div class="relative overflow-hidden mb-4">
      <div class="flex gap-6 items-stretch animate-marquee-left will-change-transform">
        {rowOne.map((testimonial, idx) => (
          <div class="bg-white p-8 transition-all duration-300 border border-gray-200 rounded-2xl w-[360px] min-h-[280px] flex flex-col justify-between flex-shrink-0 hover:border-gray-300">
            <p class="text-gray-700 text-base leading-relaxed mb-8 line-clamp-5 flex-grow">
              {testimonial.text}
            </p>
            <div class="flex items-center justify-between mt-auto">
              <div class="flex items-center space-x-3">
                <img 
                  src={testimonial.avatar}
                  alt={testimonial.author}
                  class="w-12 h-12 rounded-full"
                />
                <div>
                  <p class="font-semibold text-gray-900 text-base">{testimonial.author}</p>
                  <p class="text-gray-500 text-sm">{testimonial.source}</p>
                </div>
              </div>
              <div class="flex-shrink-0" set:html={getSourceIcon(testimonial.sourceIcon)} />
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Row 2 - scroll right -->
    <div class="relative overflow-hidden">
      <div class="flex gap-6 items-stretch animate-marquee-right will-change-transform">
        {rowTwo.map((testimonial, idx) => (
          <div class="bg-white p-8 transition-all duration-300 border border-gray-200 rounded-2xl w-[360px] min-h-[280px] flex flex-col justify-between flex-shrink-0 hover:border-gray-300">
            <p class="text-gray-700 text-base leading-relaxed mb-8 line-clamp-5 flex-grow">
              {testimonial.text}
            </p>
            <div class="flex items-center justify-between mt-auto">
              <div class="flex items-center space-x-3">
                <img 
                  src={testimonial.avatar}
                  alt={testimonial.author}
                  class="w-12 h-12 rounded-full"
                />
                <div>
                  <p class="font-semibold text-gray-900 text-base">{testimonial.author}</p>
                  <p class="text-gray-500 text-sm">{testimonial.source}</p>
                </div>
              </div>
              <div class="flex-shrink-0" set:html={getSourceIcon(testimonial.sourceIcon)} />
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  .line-clamp-5 {
    display: -webkit-box;
    -webkit-line-clamp: 5;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Calculate exact distance: 6 cards * 360px + 6 gaps * 24px = 2304px */
  @keyframes marquee-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-2304px); }
  }
  @keyframes marquee-right {
    0% { transform: translateX(-2304px); }
    100% { transform: translateX(0); }
  }

  .animate-marquee-left {
    animation: marquee-left 40s linear infinite;
  }
  .animate-marquee-right {
    animation: marquee-right 40s linear infinite;
  }

  /* Pause on hover */
  .animate-marquee-left:hover,
  .animate-marquee-right:hover {
    animation-play-state: paused;
  }
</style>
